<UserControl x:Class="VisionPro.App.Views.LiveViewControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:VisionPro.App.ViewModels"
             Background="{StaticResource BackgroundBrush}">
    

    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="280"/>
        </Grid.ColumnDefinitions>
        
        <!-- Image Display Area -->
        <Border Grid.Column="0" Background="#1A1A2A" Margin="8" CornerRadius="8">
            <Grid>
                <!-- Image -->
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                    <Image Source="{Binding CurrentImage}" 
                           RenderOptions.BitmapScalingMode="NearestNeighbor"
                           Stretch="None"
                           HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Image.LayoutTransform>
                            <ScaleTransform ScaleX="{Binding ZoomLevel}" ScaleY="{Binding ZoomLevel}"/>
                        </Image.LayoutTransform>
                    </Image>
                </ScrollViewer>
                
                <!-- Overlay Info -->
                <Border Background="#88000000" CornerRadius="4" Padding="8" 
                        HorizontalAlignment="Left" VerticalAlignment="Top" Margin="8">
                    <StackPanel>
                        <TextBlock Foreground="White" FontFamily="Consolas" FontSize="11">
                            <Run Text="Resolution: "/><Run Text="{Binding ImageWidth}"/><Run Text=" x "/><Run Text="{Binding ImageHeight}"/>
                        </TextBlock>
                        <TextBlock Foreground="White" FontFamily="Consolas" FontSize="11">
                            <Run Text="FPS: "/><Run Text="{Binding Fps, StringFormat='{}{0:F1}'}"/>
                        </TextBlock>
                        <TextBlock Foreground="White" FontFamily="Consolas" FontSize="11">
                            <Run Text="Zoom: "/><Run Text="{Binding ZoomLevel, StringFormat='{}{0:P0}'}"/>
                        </TextBlock>
                    </StackPanel>
                </Border>
                
                <!-- Zoom Controls -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="8">
                    <Button Content="âˆ’" Width="32" Height="32" Margin="4,0" Command="{Binding ZoomOutCommand}"/>
                    <Button Content="âŒ–" Width="32" Height="32" Margin="4,0" Command="{Binding ZoomFitCommand}"/>
                    <Button Content="+" Width="32" Height="32" Margin="4,0" Command="{Binding ZoomInCommand}"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Control Panel -->
        <Border Grid.Column="1" Background="{StaticResource SurfaceBrush}" Margin="0,8,8,8" CornerRadius="8" Padding="16">
            <StackPanel>
                <TextBlock Text="Camera Controls" FontSize="16" FontWeight="SemiBold" 
                           Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,16"/>
                
                <!-- Status -->
                <TextBlock Text="Status" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                <Border Background="#333344" CornerRadius="4" Padding="12,8" Margin="0,0,0,16">
                    <TextBlock Text="{Binding StatusText}" Foreground="{StaticResource TextPrimaryBrush}"/>
                </Border>
                
                <!-- Connection -->
                <Button Content="ðŸ”Œ Connect Camera" Margin="0,0,0,8" 
                        Command="{Binding ConnectCameraCommand}"/>
                
                <!-- Capture Controls -->
                <Button Content="â–¶ Start Capture" Margin="0,8,0,4" 
                        Command="{Binding StartCaptureCommand}"/>
                
                <Button Content="â¹ Stop Capture" Margin="0,4,0,4" 
                        Background="{StaticResource NGBrush}"
                        Command="{Binding StopCaptureCommand}"/>
                
                <Button Content="ðŸ“¸ Snapshot" Margin="0,4,0,16" 
                        Background="{StaticResource SecondaryBrush}"
                        Command="{Binding CaptureSnapshotCommand}"/>
                
                <Separator Background="#444" Margin="0,8"/>
                
                <!-- Image Info -->
                <TextBlock Text="Image Information" FontSize="14" FontWeight="SemiBold"
                           Foreground="{StaticResource TextPrimaryBrush}" Margin="0,16,0,8"/>
                
                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Width:" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock Grid.Column="1" Text="{Binding ImageWidth}" Foreground="{StaticResource TextPrimaryBrush}"/>
                </Grid>
                
                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Height:" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock Grid.Column="1" Text="{Binding ImageHeight}" Foreground="{StaticResource TextPrimaryBrush}"/>
                </Grid>
                
                <Grid Margin="0,4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Frame Rate:" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock Grid.Column="1" Text="{Binding Fps, StringFormat='{}{0:F1} fps'}" Foreground="{StaticResource TextPrimaryBrush}"/>
                </Grid>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
